import Head from "next/head";
/* eslint-disable @next/next/no-img-element */
import Link from "next/link";
import { supabase } from "./api/supabase";
import { Navigation } from "swiper";
import { Grid } from "@mui/material";
import Backdrop from "@mui/material/Backdrop";
import { FIRST_PATH } from "../constants/Constant";
import "swiper/css";
import "swiper/css/navigation";
import "swiper/css/grid";
import "swiper/css/pagination";
import { Swiper, SwiperSlide } from "swiper/react";
import Typography from "@mui/material/Typography";

import { useEffect, useState } from "react";

export const getServerSideProps = async () => {
  const res = await supabase
    .from("blog")
    .select()
    .order("id", { ascending: false });

  console.log("res", res.data);
  const blogs = res.data;

  return { props: { blogs } };
};

export default function Home({ blogs }) {
  const [open, setOpen] = useState(true);
  const [aboutData, setAboutData] = useState();
  const [revolvingData, setRevolvingData] = useState();

  useEffect(() => {
    getHomeData();
    setTimeout(() => {
      setOpen(false);
    }, 500);
  }, []);

  // const getAboutData = () => {
  //   supabase
  //     .from("authentication")
  //     .select()
  //     .eq("email", "drharis@test.com")
  //     .single()
  //     .then((response) => {
  //       console.log("response", response?.data);
  //       setAboutData(response?.data?.items);
  //     });
  // };
  const getHomeData = async () => {
    const res = await supabase
      .from("home")
      .select()
      .select()
      .order("id", { ascending: false })
      .then((response) => {
        console.log("re", response);
        setAboutData(response?.data?.[0].items);
        setRevolvingData(response?.data?.[0].revolvingItems);
      });
  };
  return (
    <Grid>
      <Head>
        <title>Medical Portfolio</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
      <Backdrop
        sx={{
          color: "#89C1CB",
          backgroundColor: "#89C1CB",
          zIndex: (theme) => theme.zIndex.drawer + 1,
        }}
        open={open}
      >
        <Grid>
          <img
            width={"100%"}
            height={100}
            alt={"Image"}
            src={"/assets/icon/applogo.png"}
          ></img>
        </Grid>
      </Backdrop>
      <Grid mb={4} mt={2}>
        <div className="author_logo">
          {revolvingData?.map((x, index) => (
            <img
              key={index}
              src={`${FIRST_PATH}${x?.value}`}
              alt="iamge"
              width={"30%"}
              height={300}
              className="carousel_item"
            />
          ))}
        </div>
      </Grid>
      <Grid mb={5} mt={2}>
        <Swiper navigation={true} modules={[Navigation]} slidesPerView={1}>
          {aboutData?.map((x) => {
            return (
              <SwiperSlide key={x}>
                <Link href={x?.url}>
                  <img
                    src={`${FIRST_PATH}${x?.value}`}
                    alt="iamge"
                    width={"100%"}
                    style={{
                      maxHeight: 600,
                    }}
                  />
                </Link>
              </SwiperSlide>
            );
          })}
        </Swiper>
      </Grid>
    </Grid>
  );
}
